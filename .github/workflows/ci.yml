name: Code Check # –Ω–∞–∑–≤–∞–Ω–∏–µ

on: [push, pull_request] # –∑–∞–ø—É—Å–∫–∞—Ç—å –ø—Ä–∏ –ª—é–±–æ–º –ø—É—à–µ –≤ –ª—é–±—É—é –≤–µ—Ç–∫—É –∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –ø—É–ª–ª —Ä–µ–∫–≤–µ—Å—Ç–∞

jobs: # —Ç–æ —á—Ç–æ –¥–µ–ª–∞–µ—Ç –ø–∞–π–ø–ª–∞–π–Ω
  check_html: # –Ω–∞–∑–≤–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
    runs-on: ubuntu-latest # –∑–∞–ø—É—Å–∫ –Ω–∞ –ª–∞—Å—Ç –≤–µ—Ä—Å–∏–∏ —É–±—É–Ω—Ç—É

    steps: # –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å —à–∞–≥–æ–≤
      # 1: –ø–æ–ª—É—á–∞—Ç—å –∫–æ–¥ –∏–∑ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
      - name: Checkout code
        uses: actions/checkout@v4 # –∑–∞–≥—Ä—É–∑–∫–∞ –∫–æ–¥–∞ 

      # 2: —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Node.js –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'

      # 3: –ø—Ä–æ–≤–µ—Ä–∫–∞ html —Å –ø–æ–º–æ—â—å—é html-proofer
      - name: Setup HTMLProofer
        run: |
          sudo apt-get update
          sudo apt-get install -y ruby-full
          sudo gem install html-proofer
      - name: Check file structure
        run: |
          echo "–ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –ø—Ä–æ–µ–∫—Ç–∞..."
          if [ ! -f "index.html" ]; then echo "ERROR: index.html not found!"; exit 1; fi
          echo "‚úì –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤ –ø–æ—Ä—è–¥–∫–µ"
        
      - name: Run HTMLProofer
        run: |
          htmlproofer . --checks html --disable-external --allow-hash-href
  notify-telegram:
    runs-on: ubuntu-latest
    needs: check_html
    if: always() # –í—Å–µ–≥–¥–∞ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è, –¥–∞–∂–µ –µ—Å–ª–∏ –ø—Ä–µ–¥—ã–¥—É—â–∏–π job —É–ø–∞–ª
    name: Telegram Notification
    steps:
      - name: Send Telegram notification
        uses: appleboy/telegram-action@v0.1.0
        with:
          to: ${{ secrets.TELEGRAM_CHAT_ID }}
          token: ${{ secrets.TELEGRAM_BOT_TOKEN }}
          message: |
            üöÄ CI/CD –°—Ç–∞—Ç—É—Å
            --------------------------
            üìÅ –ü—Ä–æ–µ–∫—Ç: ${{ github.repository }}
            üîñ –í–µ—Ç–∫–∞: ${{ github.ref_name }}
            üë§ –ê–≤—Ç–æ—Ä: ${{ github.actor }}
            --------------------------
            üìä –°—Ç–∞—Ç—É—Å: ${{ job.status }}
            ‚úÖ –¢–µ—Å—Ç—ã: ${{ needs.check_html.result }}
            --------------------------
            üîó View Results: https://github.com/${{ github.repository }}/actions/runs/${{ github.run_id }}
            üåê Live Site: my-portfolio-git-main-egors-projects-ec1924bf.vercel.app
          format: html
